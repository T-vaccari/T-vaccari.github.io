<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2025-01-24T17:53:31+01:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">My portfolio</title><subtitle>Tommaso Vaccari&apos;s Portfolio</subtitle><entry><title type="html">Building a Simple Web App with Firebase Authentication and Firestore: A Step-by-Step Guide</title><link href="http://localhost:4000/blog/post/2024/08/28/Eisenhower_Matrix.html" rel="alternate" type="text/html" title="Building a Simple Web App with Firebase Authentication and Firestore: A Step-by-Step Guide" /><published>2024-08-28T00:00:00+02:00</published><updated>2024-08-28T00:00:00+02:00</updated><id>http://localhost:4000/blog/post/2024/08/28/Eisenhower_Matrix</id><content type="html" xml:base="http://localhost:4000/blog/post/2024/08/28/Eisenhower_Matrix.html"><![CDATA[<p>In today’s post, I’ll walk you through the development of a simple web application, showcasing how to leverage Firebase Authentication and Firestore Database. This guide will help you understand how to:</p>

<ol>
  <li>Authenticate users with Firebase Authentication.</li>
  <li>Store and retrieve data in real time using Firestore.</li>
</ol>

<p>To make things more practical, we’ll build an application based on the <a href="https://en.wikipedia.org/wiki/Time_management#The_Eisenhower_Method">Eisenhower Matrix</a>, a powerful decision-making framework that helps you prioritize tasks based on urgency and importance.</p>

<p>If you want to see the final result in action, feel free to explore the app <a href="https://eisenhower-matrix.tommasovaccari.com">here</a>.</p>

<h2 id="what-is-the-eisenhower-matrix">What is the Eisenhower Matrix?</h2>

<p>The Eisenhower Matrix is divided into four quadrants:</p>

<ul>
  <li><strong>Quadrant 1</strong>: Urgent and Important</li>
  <li><strong>Quadrant 2</strong>: Not Urgent but Important</li>
  <li><strong>Quadrant 3</strong>: Urgent but Not Important</li>
  <li><strong>Quadrant 4</strong>: Neither Urgent nor Important</li>
</ul>

<p>This framework helps you classify tasks and make better decisions about what to prioritize, what to plan for later, and what to delegate or remove.</p>

<h2 id="overview-of-the-app">Overview of the App</h2>

<p>My web application brings the Eisenhower Matrix to life allowing users to:</p>

<ul>
  <li><strong>Create an account</strong> using Firebase Authentication.</li>
  <li><strong>Add tasks</strong> and assign them to one of the four quadrants (Urgent/Important, Not Urgent/Important, Urgent/Not Important, Not Urgent/Not Important).</li>
  <li><strong>Move tasks dynamically</strong> between quadrants as priorities change.</li>
  <li><strong>Store tasks</strong> securely in the cloud using Firestore, ensuring persistence across sessions and accessibility from any device.</li>
</ul>

<h3 id="core-components">Core Components</h3>

<ul>
  <li><strong>Firebase Authentication</strong>: Enables users to create accounts, log in, and secure access to their personalized task data.</li>
  <li><strong>Firestore Database</strong>: A NoSQL cloud database that stores user tasks in real time, ensuring that changes are immediately reflected in the UI and synced across devices.</li>
  <li><strong>HTML, JavaScript, and CSS</strong>: The front-end is built using standard web technologies. HTML structures the layout, JavaScript provides interactivity (e.g., adding and moving tasks), and CSS ensures the app is visually appealing and user-friendly.</li>
</ul>

<h2 id="why-firebase">Why Firebase?</h2>

<p>Firebase provides a robust suite of tools, making it ideal for small projects like this. It offers both authentication and database features, allowing you to manage user sessions and store data without having to set up complex backend infrastructure. The <strong>free tier</strong> is more than enough for small projects, allowing you to build and launch an app without any initial cost.</p>

<h2 id="step-by-step-guide">Step-by-Step Guide</h2>

<p>Now, let’s dive into the app construction, step by step.</p>

<h3 id="step-1-setting-up-firebase">Step 1: Setting Up Firebase</h3>

<ol>
  <li>Go to the <a href="https://console.firebase.google.com">Firebase Console</a> and create a new project.</li>
  <li>Enable <strong>Firebase Authentication</strong>: Navigate to the “Authentication” tab, click “Set up sign-in method”, and enable <strong>Email/Password</strong> authentication.</li>
  <li>Enable <strong>Firestore Database</strong>: In the “Firestore Database” section, click “Create database”, and choose the appropriate settings for your app (test mode is fine for development).</li>
</ol>

<p>Now you’re ready to integrate Firebase into your app!</p>

<h3 id="step-2--integrate-firebase-into-the-web-app">Step 2 : Integrate Firebase into the Web App</h3>

<p>Once you’ve completed the basic structure and styling of your web application using HTML and CSS, you can now integrate Firebase services to handle authentication and data storage.</p>

<p>To do this, you need to import the necessary Firebase modules directly into your JavaScript file. Firebase provides a modern way to handle individual services using ES modules, which makes your code more modular and lightweight.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">initializeApp</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">getAuth</span><span class="p">,</span> <span class="nx">signInWithEmailAndPassword</span><span class="p">,</span> <span class="nx">createUserWithEmailAndPassword</span><span class="p">,</span> <span class="nx">onAuthStateChanged</span><span class="p">,</span> <span class="nx">signOut</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">getFirestore</span><span class="p">,</span> <span class="nx">doc</span><span class="p">,</span> <span class="nx">setDoc</span><span class="p">,</span> <span class="nx">collection</span><span class="p">,</span> <span class="nx">addDoc</span><span class="p">,</span> <span class="nx">onSnapshot</span><span class="p">,</span> <span class="nx">deleteDoc</span><span class="p">,</span> <span class="nx">query</span><span class="p">,</span> <span class="nx">where</span><span class="p">,</span> <span class="nx">limit</span><span class="p">,</span> <span class="nx">startAfter</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js</span><span class="dl">"</span><span class="p">;</span>

</code></pre></div></div>

<ul>
  <li>initializeApp: This function is essential to start using Firebase in your app. It initializes Firebase using your project’s configuration details.</li>
</ul>

<p>Authentication Services:</p>

<ul>
  <li>getAuth: Initializes Firebase Authentication, which is used to manage users and their login status..</li>
  <li>signInWithEmailAndPassword: Allows users to log in using their email and password.</li>
  <li>createUserWithEmailAndPassword: Enables new user registration with email and password.</li>
  <li>onAuthStateChanged: Listens to changes in authentication state, allowing you to track whether a user is logged in or logged out.</li>
  <li>signOut: Provides a method to log users out of the application.</li>
</ul>

<p>Firestore Services:</p>

<ul>
  <li>getFirestore: Initializes Firestore, the cloud database service that stores and syncs data in real time.
doc and setDoc: Used to create or reference specific documents in the Firestore database (for example, tasks in our Eisenhower Matrix app).</li>
  <li>collection and addDoc: Create or add data to a Firestore collection, such as adding a task to a user’s list.</li>
  <li>onSnapshot: Listens to real-time changes in the database, so your app automatically reflects any updates made by the user.</li>
  <li>deleteDoc: Allows you to delete specific documents (e.g., remove tasks).</li>
  <li>query, where, limit, startAfter: Firestore query methods, which let you filter, paginate, and retrieve data efficiently from large collections.</li>
</ul>

<p>By importing these modules, you only load the specific functionality you need for your web app, which is a more efficient approach, especially for smaller projects.</p>

<h3 id="step-3--firebase-configuration-and-initialization">Step 3 : Firebase Configuration and Initialization</h3>

<p>Now you have to obtain the setting of your firebase project. You can find them in the setting section on the firebase console.</p>

<p>In your javascript file, initialize Firebase using the config setting :</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Firebase config (replace with your own Firebase project settings)</span>
<span class="kd">const</span> <span class="nx">firebaseConfig</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="dl">"</span><span class="s2">YOUR_API_KEY</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">authDomain</span><span class="p">:</span> <span class="dl">"</span><span class="s2">YOUR_AUTH_DOMAIN</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">projectId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">YOUR_PROJECT_ID</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">storageBucket</span><span class="p">:</span> <span class="dl">"</span><span class="s2">YOUR_STORAGE_BUCKET</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">messagingSenderId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">YOUR_MESSAGING_SENDER_ID</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">appId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">YOUR_APP_ID</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nf">initializeApp</span><span class="p">(</span><span class="nx">firebaseConfig</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">auth</span> <span class="o">=</span> <span class="nf">getAuth</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">db</span> <span class="o">=</span> <span class="nf">getFirestore</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>

</code></pre></div></div>

<h3 id="step-4-implement-firebase-authentication">Step 4: Implement Firebase Authentication</h3>

<p>Now that Firebase is initialized, let’s handle user authentication. We’ll add functionality for both signing up and logging in.
Now for the sake of clarity I use as an ID ‘signUp’ and ‘logn’ ,then you have to change it with the ID that you used in your HTML.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Sign up new users</span>
<span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">signUp</span><span class="dl">'</span><span class="p">).</span><span class="nf">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">email</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">password</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    
    <span class="nx">auth</span><span class="p">.</span><span class="nf">createUserWithEmailAndPassword</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">then</span><span class="p">(</span><span class="nx">userCredential</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">User signed up!</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nf">alert</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
        <span class="p">});</span>
<span class="p">});</span>

<span class="c1">// Log in existing users</span>
<span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">login</span><span class="dl">'</span><span class="p">).</span><span class="nf">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">email</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">password</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    
    <span class="nx">auth</span><span class="p">.</span><span class="nf">signInWithEmailAndPassword</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">then</span><span class="p">(</span><span class="nx">userCredential</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">User logged in!</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nf">alert</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
        <span class="p">});</span>
<span class="p">});</span>

</code></pre></div></div>

<h3 id="step-5-firestore-for-storing-tasks">Step 5: Firestore for Storing Tasks</h3>

<p>Once the user is logged in, we’ll allow them to add and remove tasks to Firestore. Each task will be saved under the user’s unique ID in the Firestore database.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Add a task to Firestore</span>
<span class="kd">function</span> <span class="nf">addTask</span><span class="p">(</span><span class="nx">quadrantId</span><span class="p">,</span> <span class="nx">task</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">userId</span> <span class="o">=</span> <span class="nf">getCurrentUserId</span><span class="p">();</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">userId</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">tasksRef</span> <span class="o">=</span> <span class="nf">collection</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="s2">`users/</span><span class="p">${</span><span class="nx">userId</span><span class="p">}</span><span class="s2">/tasks`</span><span class="p">);</span>
    <span class="nf">addDoc</span><span class="p">(</span><span class="nx">tasksRef</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">text</span><span class="p">:</span> <span class="nx">task</span><span class="p">,</span>
        <span class="na">quadrant</span><span class="p">:</span> <span class="nx">quadrantId</span><span class="p">,</span>
        <span class="na">createdAt</span><span class="p">:</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">()</span>
    <span class="p">}).</span><span class="nf">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">//console.log("Task added successfully");</span>
    <span class="p">}).</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Error adding task: </span><span class="dl">"</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
<span class="c1">//Remove task from firestore</span>
<span class="kd">function</span> <span class="nf">deleteTask</span><span class="p">(</span><span class="nx">taskId</span><span class="p">,</span> <span class="nx">taskItem</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">userId</span> <span class="o">=</span> <span class="nf">getCurrentUserId</span><span class="p">();</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">userId</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">taskRef</span> <span class="o">=</span> <span class="nf">doc</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="s2">`users/</span><span class="p">${</span><span class="nx">userId</span><span class="p">}</span><span class="s2">/tasks/</span><span class="p">${</span><span class="nx">taskId</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="nf">deleteDoc</span><span class="p">(</span><span class="nx">taskRef</span><span class="p">).</span><span class="nf">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">taskItem</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nf">removeChild</span><span class="p">(</span><span class="nx">taskItem</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Task deleted successfully</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}).</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Error deleting task: </span><span class="dl">"</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>

</code></pre></div></div>

<h3 id="step-6-displaying-tasks-in-real-time">Step 6: Displaying Tasks in Real Time</h3>

<p>Firestore provides real-time listeners, which we’ll use to display tasks as soon as they’re added.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">auth</span><span class="p">.</span><span class="nf">onAuthStateChanged</span><span class="p">(</span><span class="nx">user</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Listen for changes to the user's task list in Firestore</span>
        <span class="nx">db</span><span class="p">.</span><span class="nf">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">).</span><span class="nf">doc</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">uid</span><span class="p">).</span><span class="nf">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">tasks</span><span class="dl">'</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">orderBy</span><span class="p">(</span><span class="dl">'</span><span class="s1">timestamp</span><span class="dl">'</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">onSnapshot</span><span class="p">(</span><span class="nx">snapshot</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">taskList</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">taskList</span><span class="dl">'</span><span class="p">);</span>
                <span class="nx">taskList</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>  <span class="c1">// Clear previous tasks</span>
                
                <span class="nx">snapshot</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(</span><span class="nx">doc</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">taskItem</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">li</span><span class="dl">'</span><span class="p">);</span>
                    <span class="nx">taskItem</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nf">data</span><span class="p">().</span><span class="nx">task</span><span class="p">;</span>
                    <span class="nx">taskList</span><span class="p">.</span><span class="nf">appendChild</span><span class="p">(</span><span class="nx">taskItem</span><span class="p">);</span>
                <span class="p">});</span>
            <span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre></div></div>

<h3 id="step-7-putting-it-all-together">Step 7: Putting It All Together</h3>

<p>At this point, we’ve successfully integrated Firebase Authentication and Firestore. Here’s what happens in our app:</p>

<ol>
  <li>User Authentication: Users can sign up or log in.</li>
  <li>Task Management: Once authenticated, users can add tasks to Firestore.</li>
  <li>Real-Time Updates: Tasks are displayed in real-time, so users can see updates immediately.</li>
</ol>

<h2 id="conclusion">Conclusion</h2>

<p>Integrating Firebase Authentication and Firestore into your web application offers a streamlined, serverless solution for managing both user authentication and real-time data storage. In our example, we demonstrated how to build a task management app using the Eisenhower Matrix, but the principles outlined here can easily be extended to a wide range of web applications. Firebase’s suite of tools enables you to focus on your front-end development while it handles the complexities of authentication, database management, and scalability.</p>

<p>What makes Firebase especially appealing is its simplicity and scalability—whether you’re working on small projects or building apps with large-scale needs, Firebase can handle it. The free tier is particularly beneficial for smaller applications or prototypes, allowing you to develop and deploy without upfront costs.</p>

<p>If you’re looking to expand beyond this, Firebase offers a rich ecosystem of services, including Cloud Functions, Hosting, and Analytics, which can further enhance your app’s functionality and performance. These tools, combined with Firebase’s real-time synchronization and seamless cross-platform support, can significantly reduce development time and effort, while ensuring a robust and scalable application.</p>

<p>Explore Firebase’s extensive <a href="https://firebase.google.com/docs/">documentation</a> to dive deeper into these tools, and take your web app to the next level. Happy coding!</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[In today’s post, I’ll walk you through the development of a simple web application, showcasing how to leverage Firebase Authentication and Firestore Database. This guide will help you understand how to:]]></summary></entry><entry><title type="html">Building a Daily Vocabulary Newsletter with Python, Google Docs, and Google Sheets</title><link href="http://localhost:4000/blog/post/2024/08/21/EnglishNewsletter.html" rel="alternate" type="text/html" title="Building a Daily Vocabulary Newsletter with Python, Google Docs, and Google Sheets" /><published>2024-08-21T00:00:00+02:00</published><updated>2024-08-21T00:00:00+02:00</updated><id>http://localhost:4000/blog/post/2024/08/21/EnglishNewsletter</id><content type="html" xml:base="http://localhost:4000/blog/post/2024/08/21/EnglishNewsletter.html"><![CDATA[<p>In today’s post, I’d like to share a simple app I developed to improve my English vocabulary. This app is a daily newsletter that sends me and to other subscribers  vocabulary words, and the twist is that it uses Google Docs as the database for storing the vocabulary words and their meanings, while Google Sheets is used to manage user subscriptions and track the words I’ve already studied.</p>

<p>I decided to create this tool because I’m actively learning English and wanted an automated way to refresh and expand my vocabulary. Since I have experience with Python and APIs, I took the opportunity to integrate Google Docs and Google Sheets APIs to store and manage vocabulary words and user data.</p>

<p>You can see the code in my <a href="https://github.com/T-vaccari/VocabularyNewsletter">github repo</a></p>

<h2 id="overview-of-the-app">Overview of the app</h2>

<p>Core Components:</p>

<ol>
  <li>Google Docs: Serves as the vocabulary database, containing a list of words and their meanings.</li>
  <li>Google Sheets: Manages subscriber information and tracks vocabulary word appearances.</li>
  <li>Email Automation: Sends out daily emails with a curated list of vocabulary words.</li>
</ol>

<p>Here’s how everything fits together:</p>

<ul>
  <li>Google Docs stores the vocabulary words along with their meanings, formatted like this:
word ||| meaning.</li>
  <li>Google Sheets maintains a list of recipients, along with metadata such as which document they are pulling their words from and whether they should receive an email on any given day.</li>
  <li>The app pulls a random set of words from Google Docs, formats them into an email, and sends it to the user.</li>
</ul>

<h2 id="why-using-google-suit-and-relative-apis">Why using Google Suit and relative APIs</h2>

<p>There are many reasons I chose Google Docs and Google Sheets for this app:</p>

<ul>
  <li>Google Docs: It allows me to easily add, update, and manage vocabulary terms in a simple, familiar text environment.</li>
  <li>Google Sheets: This is a natural choice for tracking user data, such as which words have already been sent, email preferences, and other metadata.</li>
  <li>Google API Integration: Google provides powerful APIs that allow seamless interaction with both Docs and Sheets, making it easy to read, write, and update data programmatically.</li>
</ul>

<h2 id="how-it-works">How It Works</h2>

<h3 id="1-fetching-recipients-and-their-vocabulary-database-from-google-sheets">1. Fetching Recipients and Their Vocabulary Database from Google Sheets</h3>

<p>The Google Sheet must be structured as follows: Email, DOCUMENT ID, SHEET ID, and a flag to receive the newsletter.</p>

<p><img src="/assets/images/IMG_123.png" alt="Sheet" /></p>

<p>The function <code class="language-plaintext highlighter-rouge">start_vocab_app()</code> retrieves recipient details, including their vocabulary document and tracking sheet IDs. It then uses the provided Google Sheets API to extract this data and determine which subscribers should receive the newsletter.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">start_vocab_app</span><span class="p">():</span>
  <span class="n">SHEET_ID</span> <span class="o">=</span> <span class="sh">""</span>  <span class="c1"># Insert the SHEET ID used for the database
</span>  <span class="n">SCOPES</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">https://www.googleapis.com/auth/spreadsheets</span><span class="sh">'</span><span class="p">]</span>
  <span class="n">credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="p">.</span><span class="n">Credentials</span><span class="p">.</span><span class="nf">from_service_account_file</span><span class="p">(</span><span class="n">SERVICE_ACCOUNT_FILE</span><span class="p">,</span> <span class="n">scopes</span><span class="o">=</span><span class="n">SCOPES</span><span class="p">)</span>
  <span class="n">service</span> <span class="o">=</span> <span class="nf">build</span><span class="p">(</span><span class="sh">'</span><span class="s">sheets</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">v4</span><span class="sh">'</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
  <span class="n">SHEET_RANGE</span> <span class="o">=</span> <span class="sh">""</span>  <span class="c1"># Range to read data in the SHEET
</span>  <span class="n">sheet</span> <span class="o">=</span> <span class="n">service</span><span class="p">.</span><span class="nf">spreadsheets</span><span class="p">()</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">.</span><span class="nf">values</span><span class="p">().</span><span class="nf">get</span><span class="p">(</span><span class="n">spreadsheetId</span><span class="o">=</span><span class="n">SHEET_ID</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">SHEET_RANGE</span><span class="p">).</span><span class="nf">execute</span><span class="p">()</span>
  <span class="n">values</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">values</span><span class="sh">'</span><span class="p">,</span> <span class="p">[])</span>
  <span class="n">recipients</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">recipients</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">thing</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>

  <span class="k">for</span> <span class="n">email</span><span class="p">,</span> <span class="n">features</span> <span class="ow">in</span> <span class="n">recipients</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="nf">if </span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]).</span><span class="nf">lower</span><span class="p">()</span> <span class="o">==</span> <span class="sh">"</span><span class="s">no</span><span class="sh">"</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="nf">read_google_doc</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">email_body</span> <span class="o">=</span> <span class="nf">create_email_body</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="nf">send_email</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">email_body</span><span class="p">)</span>
      
        <span class="k">if</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="sh">'</span><span class="s">.</span><span class="sh">'</span><span class="p">:</span>
          <span class="nf">counting_words</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
      
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">logging</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Errore per il destinatario </span><span class="si">{</span><span class="n">email</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
      <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Errore con </span><span class="si">{</span><span class="n">email</span><span class="si">}</span><span class="s">. Passo al destinatario successivo.</span><span class="sh">"</span><span class="p">)</span>
      <span class="k">continue</span>
</code></pre></div></div>

<h3 id="2-fetching-vocabulary-from-google-docs">2. Fetching Vocabulary from Google Docs</h3>

<p>The app reads vocabulary words from a specific Google Doc using the Google Docs API. Each line in the document is formatted as a word and its meaning separated by ||| (I used it for parsing pursuits).Here is how it mus look like to work with the script :</p>

<p><img src="/assets/images/IMG_124.png" alt="DOC" /></p>

<p>Here’s the part of the code that reads the words and returns the one that are selected randomly :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read_google_doc</span><span class="p">(</span><span class="n">DOCUMENT_ID</span><span class="p">):</span>
    <span class="n">SCOPES</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">https://www.googleapis.com/auth/documents.readonly</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">wordstosend</span> <span class="o">=</span> 
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="p">.</span><span class="n">Credentials</span><span class="p">.</span><span class="nf">from_service_account_file</span><span class="p">(</span>
        <span class="n">SERVICE_ACCOUNT_FILE</span><span class="p">,</span> <span class="n">scopes</span><span class="o">=</span><span class="n">SCOPES</span><span class="p">)</span>
    <span class="n">service</span> <span class="o">=</span> <span class="nf">build</span><span class="p">(</span><span class="sh">'</span><span class="s">docs</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">v1</span><span class="sh">'</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">doc</span> <span class="o">=</span> <span class="n">service</span><span class="p">.</span><span class="nf">documents</span><span class="p">().</span><span class="nf">get</span><span class="p">(</span><span class="n">documentId</span><span class="o">=</span><span class="n">DOCUMENT_ID</span><span class="p">).</span><span class="nf">execute</span><span class="p">()</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">body</span><span class="sh">'</span><span class="p">).</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">)</span>

    <span class="n">text</span> <span class="o">=</span> <span class="sh">""</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
        <span class="k">if</span> <span class="sh">'</span><span class="s">paragraph</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="n">element</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">paragraph</span><span class="sh">'</span><span class="p">).</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">elements</span><span class="sh">'</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                <span class="n">text_run</span> <span class="o">=</span> <span class="n">elem</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">textRun</span><span class="sh">'</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">text_run</span><span class="p">:</span>
                    <span class="n">text</span> <span class="o">+=</span> <span class="n">text_run</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="nf">strip</span><span class="p">().</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">term_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="sh">'</span><span class="s">|||</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">term</span><span class="p">,</span> <span class="n">meaning</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">|||</span><span class="sh">'</span><span class="p">)</span>
            <span class="n">term_list</span><span class="p">.</span><span class="nf">append</span><span class="p">([</span><span class="n">term</span><span class="p">.</span><span class="nf">strip</span><span class="p">(),</span> <span class="n">meaning</span><span class="p">.</span><span class="nf">strip</span><span class="p">()])</span>

    <span class="n">number</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">term_list</span><span class="p">),</span> <span class="n">wordstosend</span><span class="p">)</span>
    <span class="n">random</span><span class="p">.</span><span class="nf">shuffle</span><span class="p">(</span><span class="n">term_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">random</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="n">term_list</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>


</code></pre></div></div>

<h3 id="3-tracking-logs-in-google-sheet">3. Tracking Logs in Google Sheet</h3>

<p>We maintain a log of each word that is sent through the newsletter to ensure accurate tracking and to see what words the subscribers has already learned. Here’s the code :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">counting_words</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">SHEET_ID</span><span class="p">):</span>
    <span class="n">SCOPES</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">https://www.googleapis.com/auth/spreadsheets</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="p">.</span><span class="n">Credentials</span><span class="p">.</span><span class="nf">from_service_account_file</span><span class="p">(</span><span class="n">SERVICE_ACCOUNT_FILE</span><span class="p">,</span> <span class="n">scopes</span><span class="o">=</span><span class="n">SCOPES</span><span class="p">)</span>
    <span class="n">service</span> <span class="o">=</span> <span class="nf">build</span><span class="p">(</span><span class="sh">'</span><span class="s">sheets</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">v4</span><span class="sh">'</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
    <span class="n">SHEET_RANGE</span> <span class="o">=</span> <span class="sh">""</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">service</span><span class="p">.</span><span class="nf">spreadsheets</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">.</span><span class="nf">values</span><span class="p">().</span><span class="nf">get</span><span class="p">(</span><span class="n">spreadsheetId</span><span class="o">=</span><span class="n">SHEET_ID</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">SHEET_RANGE</span><span class="p">).</span><span class="nf">execute</span><span class="p">()</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">values</span><span class="sh">'</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">my_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]}</span>  

    <span class="n">modified_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>  
    <span class="n">english_terms</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">terms</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="n">english_terms</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">english_terms</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">modified_values</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">english_terms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="p">:</span>
            <span class="n">modified_values</span><span class="p">.</span><span class="nf">append</span><span class="p">([</span><span class="n">word</span><span class="p">,</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">])</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">values</span><span class="sh">'</span><span class="p">:</span> <span class="n">modified_values</span><span class="p">}</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">service</span><span class="p">.</span><span class="nf">spreadsheets</span><span class="p">().</span><span class="nf">values</span><span class="p">().</span><span class="nf">update</span><span class="p">(</span>
        <span class="n">spreadsheetId</span><span class="o">=</span><span class="n">SHEET_ID</span><span class="p">,</span>
        <span class="nb">range</span><span class="o">=</span><span class="n">SHEET_RANGE</span><span class="p">,</span>
        <span class="n">valueInputOption</span><span class="o">=</span><span class="sh">"</span><span class="s">RAW</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">body</span><span class="o">=</span><span class="n">body</span>
    <span class="p">).</span><span class="nf">execute</span><span class="p">()</span>


</code></pre></div></div>

<h3 id="4-creating-the-body-of-the-email">4. Creating the body of the email</h3>

<p>This function generates an HTML email with vocabulary words and their meanings. It formats each word-meaning pair into a styled, centered HTML layout using basic CSS for a clean appearance. The email includes a header, a list of words for the day. The function returns the email content as an HTML string, ready for sending.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_email_body</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
    <span class="n">word_html</span> <span class="o">=</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">&lt;div style=</span><span class="sh">'</span><span class="s">text-align: center; margin: 10px 0; font-size: 24px;</span><span class="sh">'</span><span class="s">&gt;&lt;strong&gt;</span><span class="si">{</span><span class="n">word_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s"> : </span><span class="si">{</span><span class="n">word_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s">&lt;/strong&gt;&lt;/div&gt;</span><span class="sh">"</span>
        <span class="k">for</span> <span class="n">word_pair</span> <span class="ow">in</span> <span class="n">words</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="sa">f</span><span class="sh">"""</span><span class="s">
    &lt;html&gt;
    &lt;head&gt;
      &lt;style&gt;
        body 
        h1 
        h2 
        p 
        .container 
        .footer 
      &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;div class=</span><span class="sh">"</span><span class="s">container</span><span class="sh">"</span><span class="s">&gt;
        &lt;h1&gt;Daily Vocabulary&lt;/h1&gt;
        &lt;h2&gt;Here are the words for today!&lt;/h2&gt;
        </span><span class="si">{</span><span class="n">word_html</span><span class="si">}</span><span class="s">
        &lt;div class=</span><span class="sh">"</span><span class="s">footer</span><span class="sh">"</span><span class="s">&gt;
          &lt;p&gt;Keep Learning!&lt;/p&gt;
          &lt;p style=</span><span class="sh">'</span><span class="s">font-style: italic;</span><span class="sh">'</span><span class="s">&gt;Mail sent automatically. Please do not respond.&lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/body&gt;
    &lt;/html&gt;
    </span><span class="sh">"""</span>

</code></pre></div></div>

<h3 id="5-sending-the-email">5. Sending the Email</h3>

<p>Once the words are fetched and the progress tracked, the app creates an HTML email with the vocabulary words and sends it to the recipient using SMTP:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">send_email</span><span class="p">(</span><span class="n">EMAIL_DESTINATION</span><span class="p">,</span> <span class="n">email_body</span><span class="p">):</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="nc">MIMEMultipart</span><span class="p">()</span>
    <span class="n">msg</span><span class="p">[</span><span class="sh">'</span><span class="s">Subject</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Daily Vocabulary</span><span class="sh">'</span>
    <span class="n">msg</span><span class="p">[</span><span class="sh">'</span><span class="s">From</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">EMAIL_ADDRESS</span>
    <span class="n">msg</span><span class="p">[</span><span class="sh">'</span><span class="s">To</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">EMAIL_DESTINATION</span>
    <span class="n">msg</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="nc">MIMEText</span><span class="p">(</span><span class="n">email_body</span><span class="p">,</span> <span class="sh">'</span><span class="s">html</span><span class="sh">'</span><span class="p">))</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">smtplib</span><span class="p">.</span><span class="nc">SMTP_SSL</span><span class="p">(</span><span class="sh">'</span><span class="s">smtp.gmail.com</span><span class="sh">'</span><span class="p">,</span> <span class="mi">465</span><span class="p">)</span> <span class="k">as</span> <span class="n">smtp</span><span class="p">:</span>
            <span class="n">smtp</span><span class="p">.</span><span class="nf">login</span><span class="p">(</span><span class="n">EMAIL_ADDRESS</span><span class="p">,</span> <span class="n">EMAIL_PASSWORD</span><span class="p">)</span>
            <span class="n">smtp</span><span class="p">.</span><span class="nf">send_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Email inviata a </span><span class="si">{</span><span class="n">EMAIL_DESTINATION</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        
        <span class="n">logging</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Errore nell</span><span class="sh">'</span><span class="s">invio dell</span><span class="sh">'</span><span class="s">email a </span><span class="si">{</span><span class="n">EMAIL_DESTINATION</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Errore nell</span><span class="sh">'</span><span class="s">invio dell</span><span class="sh">'</span><span class="s">email a </span><span class="si">{</span><span class="n">EMAIL_DESTINATION</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>

<p>Developing this daily vocabulary newsletter has been both a fulfilling and insightful project, blending the power of Python with the versatility of Google APIs to automate and enrich the language-learning experience. By seamlessly integrating Google Docs and Google Sheets, the application efficiently handles vocabulary data, user subscriptions, and content distribution, making the learning process smoother and more interactive.</p>

<p>Beyond enhancing my English vocabulary, this tool showcases the practical benefits of leveraging APIs to streamline workflows and automate repetitive tasks. Whether you’re exploring new ways to master a language or seeking methods to boost productivity, this project underscores the potential of technology to create tailored and efficient solutions.</p>

<p>If you found value in this article, I encourage you to explore similar integrations and push the boundaries of API-driven applications. Don’t hesitate to reach out if you have any questions or want to share your own experiences with building automated tools — the possibilities are endless, and innovation is just a step away.</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[In today’s post, I’d like to share a simple app I developed to improve my English vocabulary. This app is a daily newsletter that sends me and to other subscribers vocabulary words, and the twist is that it uses Google Docs as the database for storing the vocabulary words and their meanings, while Google Sheets is used to manage user subscriptions and track the words I’ve already studied.]]></summary></entry><entry><title type="html">Neural Network : Part One</title><link href="http://localhost:4000/blog/post/2024/07/20/NeuralNetworkP1.html" rel="alternate" type="text/html" title="Neural Network : Part One" /><published>2024-07-20T00:00:00+02:00</published><updated>2024-07-20T00:00:00+02:00</updated><id>http://localhost:4000/blog/post/2024/07/20/NeuralNetworkP1</id><content type="html" xml:base="http://localhost:4000/blog/post/2024/07/20/NeuralNetworkP1.html"><![CDATA[<h2 id="introduction">Introduction</h2>

<p>In this post, I would like to introduce how neural networks are built under the hood. I will explore the essential components and mechanisms that enable neural networks to learn and make predictions. By the end of this article, you should have a clearer understanding of how these powerful models work under the hood.</p>

<h2 id="overview-of-neural-networks">Overview of Neural Networks</h2>

<p>Before starting to dive deep into neural networks I would like to roughly remind to the reader what is the main goal and how its reached. Neural networks (NNs) are a class of machine learning models inspired by the structure and function of the human brain. The primary objective of a neural network is to learn a mapping from input data to desired output values by adjusting its parameters through a process of optimization.</p>

<h3 id="1-goal-of-neural-networks">1. Goal of neural networks</h3>

<p>The central aim of a neural network is to learn how to produce accurate outputs when given specific inputs. This process involves training the network on a dataset, where each data point consists of an input and a corresponding target output. For instance, in a classification problem, the input might be an image, and the target output would be the label of the object in the image. Or maybe in a regression problem we want to train our model to answer the question how much?.</p>

<h3 id="2-training-process">2. Training Process</h3>

<h4 id="21-feeding-data-into-the-net-and-comparison-of-the-output">2.1 Feeding data into the net and comparison of the output</h4>

<p>During training, the network is provided with a set of input data and its corresponding target outputs. The network makes predictions based on the input data, which are then compared to the target outputs. This comparison is crucial for evaluating how well the network is performing.</p>

<h4 id="22-loss-function">2.2 Loss Function</h4>

<p>To quantify the difference between the network’s predictions and the target outputs, we use a loss function (or cost function). The loss function measures the prediction error. Common loss functions include Mean Squared Error for regression tasks and Cross-Entropy Loss for classification tasks. A lower value of the loss function indicates better performance of the network.</p>

<h4 id="23-optimization-via-backpropagation">2.3 Optimization via backpropagation</h4>

<p>The goal of training is to minimize the loss function, which involves finding the optimal set of parameters (weights and biases) for the network. To achieve this, we use an optimization algorithm that adjusts the parameters to reduce the loss.
Backpropagation is the method used to compute the gradients of the loss function with respect to the network’s parameters.
It involves:
Forward Pass: Computing the predictions of the network and the loss.
Backward Pass: Calculating the gradients of the loss function with respect to each parameter using the chain rule of calculus.</p>

<h4 id="24-gradient-descent">2.4 Gradient Descent</h4>

<p>Once the gradients are computed, they are used by the optimization algorithm (often gradient descent or its variants) to update the network’s parameters. The network parameters are adjusted in the direction that reduces the loss function. This process is iterated over multiple epochs (passes through the entire dataset) until the loss function converges to a minimum value or sufficiently small error.</p>

<p>Roughly speaking this is the process that we want to follow for achieving our goal.
With the foundational concepts established, we will now delve into the detailed steps required to build a neural network. Firstly, we need to create a class that represents data within our neural network. This class must track the origin of each data value, including the operations and values used to compute it, in order to facilitate accurate gradient calculation during backpropagation. We are going to call the class for representing data <em>Value</em> class.</p>

<h2 id="breakdown-of-the-code-for-the-value-class">Breakdown of the code for the Value class</h2>

<p>Now I will start to implement in code what we have seen in the foundational concepts about NN.</p>

<h3 id="building-the-basic-item-of-the-class-and-the-attribute-of-the-object">Building the basic item of the class and the attribute of the object</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Value</span><span class="p">:</span> 
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">_children</span> <span class="o">=</span> <span class="p">(),</span> <span class="n">_op</span> <span class="o">=</span> <span class="sh">''</span> <span class="p">):</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_previosly</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">_children</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_operations</span> <span class="o">=</span> <span class="n">_op</span>
        <span class="n">self</span><span class="p">.</span><span class="n">grad</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_backward</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Value(data=</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span>

</code></pre></div></div>

<p>Here we initialize the value objects with it’s own attribute. Let’s breakdown each attribute :</p>

<ul>
  <li>self.data = data, saves the value of the object</li>
  <li>self._previosly = set(_children), saves in a set the children of it’s value, that means that we save what values generated this value. Thanks to the set we can avoid duplicates</li>
  <li>self._operations =_op, we keep track of what operation generated this value</li>
  <li>self.grad = 0.0 , we initially set it to zero, then we are going to modify it accordingly to the rules of backpropagation, we store it in this attribute</li>
  <li>self._backward = lambda : None , we need to store here the function that provide to us the gradient, we set it initially to a lambda None because it dipends on the operation that generated this Value object.</li>
</ul>

<p>The <strong>repr</strong> method is used to print the value object.
So for example if we want to generate a value object we can do as follow :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="n">a</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nc">Value</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="building-the-basic-operation-and-the-relative-backward-function-for-value-object">Building the basic operation and the relative backward function for value object</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Value</span> <span class="p">:</span> 
    <span class="p">...</span> <span class="c1">#Code seen before
</span>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">other</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="sh">'</span><span class="s">+</span><span class="sh">'</span><span class="p">)</span>
    
        <span class="k">def</span> <span class="nf">_backward</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">out</span><span class="p">.</span><span class="n">grad</span>
            <span class="n">other</span><span class="p">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">out</span><span class="p">.</span><span class="n">grad</span>
        <span class="n">out</span><span class="p">.</span><span class="n">_backward</span> <span class="o">=</span> <span class="n">_backward</span>
    
        <span class="k">return</span> <span class="n">out</span>

    
</code></pre></div></div>

<p>Here we have the code for the <strong>add</strong> method.
Simply in this method  we create an out Value object featured by a new value and a set of children(the two Value object that originated it) and then we append the operation that originated that new Value object. Then from the foundamental of calculus we know that the gradient of the two children due to this operation can be calculated as shown in the code. For much more detail watch gradient explained <a href="https://en.wikipedia.org/wiki/Gradient">here</a>. Let’s watch how does the add function behave :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">a</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nc">Value</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">_previously</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="nc">Value</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="mi">3</span><span class="p">),</span><span class="nc">Value</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">_operation</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="sh">'</span><span class="s">+</span><span class="sh">'</span>

</code></pre></div></div>

<p>Now let’s look a the code for the <strong>mul</strong> method :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Value</span> <span class="p">:</span>
    <span class="p">...</span> <span class="c1">#Code seen before
</span>
    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">*</span> <span class="n">other</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="sh">'</span><span class="s">*</span><span class="sh">'</span><span class="p">)</span>
        
        <span class="k">def</span> <span class="nf">_backward</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="n">other</span><span class="p">.</span><span class="n">data</span> <span class="o">*</span> <span class="n">out</span><span class="p">.</span><span class="n">grad</span>
            <span class="n">other</span><span class="p">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">*</span> <span class="n">out</span><span class="p">.</span><span class="n">grad</span>
        <span class="n">out</span><span class="p">.</span><span class="n">_backward</span> <span class="o">=</span> <span class="n">_backward</span>
        
        <span class="k">return</span> <span class="n">out</span>

</code></pre></div></div>

<p>In the <strong>add</strong> method, we create a new Value object with a new value and a set of children, which are the two Value objects that originated this result. We also append the operation that produced this new Value object. The backward function is designed to compute the gradient according to calculus rules.</p>

<p>Note that we use the += operator when updating the .grad attribute. This is because we want to accumulate the gradient. For example, if the Value object is involved in multiple operations, the gradient should reflect all these operations, making the gradient cumulative.
Generally this is the process that we follow to create new method for operation for thi class. For the purpose of creating a neural network we need also a function that can work for us as an <a href="https://en.wikipedia.org/wiki/Activation_function">activation function</a>.
In this case we add the tanh function for this scope</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Value</span><span class="p">:</span>
   <span class="p">...</span> <span class="c1">#Code seen before
</span>    <span class="k">def</span> <span class="nf">tanh</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="p">),</span><span class="sh">'</span><span class="s">tanh</span><span class="sh">'</span><span class="p">)</span>
    
        <span class="k">def</span> <span class="nf">_backward</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">out</span><span class="p">.</span><span class="n">grad</span>
        <span class="n">out</span><span class="p">.</span><span class="n">_backward</span> <span class="o">=</span> <span class="n">_backward</span>
        
        <span class="k">return</span> <span class="n">out</span>

</code></pre></div></div>

<p>From calculus we know that tanh is defined as :</p>

\[\tanh(x) = \frac{e^{2x} - 1}{e^{2x} + 1}\]

<p>Then we can implement the backward function knowing that :</p>

\[\frac{d}{dx} \tanh(x) = 1 - \tanh^2(x)\]

<p>Now we implement the expnential method for being able of using tanh:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Value</span><span class="p">:</span>
    <span class="p">...</span><span class="c1">#Code seen before
</span>    <span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="p">),</span> <span class="sh">'</span><span class="s">exp</span><span class="sh">'</span><span class="p">)</span>
        
        <span class="k">def</span> <span class="nf">_backward</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="n">out</span><span class="p">.</span><span class="n">data</span> <span class="o">*</span> <span class="n">out</span><span class="p">.</span><span class="n">grad</span> 
        <span class="n">out</span><span class="p">.</span><span class="n">_backward</span> <span class="o">=</span> <span class="n">_backward</span>
        
        <span class="k">return</span> <span class="n">out</span>

</code></pre></div></div>

<p>We have now implemented most of the basic operations for our Value object. The final step is to implement a backward method. This method will be responsible for calling the backward functions of each object in the proper order.</p>

<h2 id="building-the-backward-method">Building the backward method</h2>

<p>Here’s the code for the function :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Value</span> <span class="p">:</span> 

    <span class="p">...</span> <span class="c1">#Code seen before
</span>
    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
    
        <span class="n">topo</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="nf">set</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">build_topo</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">visited</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">v</span><span class="p">.</span><span class="n">_previously</span><span class="p">:</span>
                <span class="nf">build_topo</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="n">topo</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="nf">build_topo</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">grad</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="n">topo</span><span class="p">):</span>
            <span class="n">node</span><span class="p">.</span><span class="nf">_backward</span><span class="p">()</span>


</code></pre></div></div>

<p>Thanks to the implementation of the Value object, we are able to construct a computation graph that captures the entire history of how a Value object was derived. This graph is formed by following the _previously set of each Value object, which tracks all the predecessor values involved in its computation.</p>

<p>To compute the gradients, we begin by focusing on the final Value object, which typically results from a loss function in a neural network. Since we are interested in the gradient of this final Value with respect to itself, we initialize its gradient (self.grad) to 1. This initialization signifies that the gradient of the final Value with respect to itself is 1.</p>

<p>Following this, we execute the backward ipass by invoking the _backward function for each Value object. This process starts with the final Value and proceeds backward through the computation graph to the initial Value objects. This reverse traversal ensures that the gradient for each Value is computed correctly based on the chain rule of differentiation, allowing us to accumulate the gradients appropriately.</p>

<p>We’ve now looked at the basics of how a neural network works. This simple approach helps us understand the core concepts behind its operation.
Now it’s time to create a very simple net.</p>

<h3 id="creating-a-neural-network">Creating a Neural Network</h3>

<p>Now we will look more deeply on how to create a net by little steps.</p>

<h4 id="create-one-artifical-neuron">Create one artifical neuron</h4>

<p>Now we can create an <a href="https://en.wikipedia.org/wiki/Artificial_neuron">artificial neuron</a> with two inputs.
This is an example of how does a neuron work :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">#Inputs x1,x1
</span>    <span class="n">x1</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="c1">#Weights w1,w2
</span>    <span class="n">w1</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="mf">6.0</span><span class="p">)</span>
    <span class="n">w2</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="o">-</span><span class="mf">4.0</span><span class="p">)</span>
    <span class="c1"># bias of the neuron
</span>    <span class="n">b</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="mf">9.8</span><span class="p">)</span>
    <span class="c1"># x1*w1 + x2*w2 + b
</span>    <span class="n">x1w1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">w1</span>
    <span class="n">x2w2</span> <span class="o">=</span> <span class="n">x2</span><span class="o">*</span><span class="n">w2</span>
    <span class="n">x1w1x2w2</span> <span class="o">=</span> <span class="n">x1w1</span> <span class="o">+</span> <span class="n">x2w2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">x1w1x2w2</span> <span class="o">+</span> <span class="n">b</span>
    <span class="c1"># Activation function
</span>    <span class="n">o</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="nf">tanh</span><span class="p">()</span>

</code></pre></div></div>

<p>o is the output of our neuron. The next step is to define a the class Neuron, here’s the code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Neuron</span><span class="p">:</span>
  
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">nin</span><span class="p">):</span>
    <span class="n">self</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
    <span class="n">self</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="nc">Value</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range </span><span class="p">(</span><span class="n">nin</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">w</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nc">Value</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
  
  <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># w * x + b
</span>    <span class="n">activation</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">wi</span><span class="p">,</span><span class="n">xi</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">w</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="n">activation</span> <span class="o">+=</span> <span class="n">wi</span><span class="o">*</span><span class="n">xi</span>
    <span class="n">activation</span><span class="o">+=</span><span class="n">self</span><span class="p">.</span><span class="n">b</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">activation</span><span class="p">.</span><span class="nf">tanh</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">out</span>
  
  <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="n">self</span><span class="p">):</span> <span class="c1">#For storing the parameters
</span>    <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">w</span> <span class="o">+</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">b</span><span class="p">]</span>


</code></pre></div></div>

<p>Here we define the class Neuron, in the <strong>init</strong> method we create the weights based on the number of input(nin) and then we create the bias Value.
When we call the Neuron it performs the activation based on the input and gives in output the result. Here’s an example of usage</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="nc">Neuron</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nc">Value</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">something</span><span class="p">)</span>

</code></pre></div></div>

<h4 id="create-a-layer">Create a layer</h4>

<p>The next step is to create a layer made of neuron, here’s the code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Layer</span><span class="p">:</span>
  
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">nin</span><span class="p">,</span> <span class="n">nout</span><span class="p">):</span>
    <span class="n">self</span><span class="p">.</span><span class="n">neurons</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">nout</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">neurons</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nc">Neuron</span><span class="p">(</span><span class="n">nin</span><span class="p">))</span>
  
  <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">neuron</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">neurons</span><span class="p">:</span>
        <span class="n">outs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">neuron</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">outs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">outs</span>
  
  <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">neuron</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">neurons</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">neuron</span><span class="p">.</span><span class="nf">parameters</span><span class="p">()]</span>

</code></pre></div></div>

<p>In the <strong>init</strong> method we initialize a layer specifing the number of input for each neuron(nin) and the number of ouput for the layer(nout).
When we call it, the <strong>call</strong> method push the input to every neuron and return the out of every neuron.</p>

<h4 id="create-the-multilayer-perceptron">Create the multilayer perceptron</h4>

<p>The final step is to create an<a href="https://en.wikipedia.org/wiki/Multilayer_perceptron">MLP fully connected</a>, here’s the code :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">MLP</span><span class="p">:</span>
  
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">nin</span><span class="p">,</span> <span class="n">nouts</span><span class="p">):</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="p">[</span><span class="n">nin</span><span class="p">]</span> <span class="o">+</span> <span class="n">nouts</span>
    <span class="n">self</span><span class="p">.</span><span class="n">layers</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nouts</span><span class="p">)):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nc">Layer</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sz</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    
  
  <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">layers</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="nf">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
  
  <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">layers</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">layer</span><span class="p">.</span><span class="nf">parameters</span><span class="p">()]</span>

</code></pre></div></div>

<p>In the <strong>init</strong> method as usual we initialize the MLP giving the number of inputs of the neurons(nin) and then a list(nouts) where we store the number of neurons for each layer. When we creare the self.layer attribute we iterate over a list that we create where we have the number of inputs and outputs require for every layer.
Now let’s give a look of how we can use it :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">]</span>
<span class="n">net</span> <span class="o">=</span> <span class="nc">MLP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="nf">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="nc">Value</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">something</span><span class="p">)</span>


</code></pre></div></div>

<p>Now we are ready to train the net that we have built.</p>

<h4 id="creating-the-dataset">Creating the dataset</h4>

<p>To start we can manually create a very easy dataset and the desired target :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">xs</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>


</code></pre></div></div>

<p>So when we feed to our net the first list we want to obtain as a result the firs element of the ys list.
Now all we need is a loss function that can tell us how good are the output of our net.
When we have our loss function we can call the backpropagation on it(remember that is a Value object so we can do it) and then we can slighly adjust the parameters according to what minimize the loss function.
Now we can implement it :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
  
    <span class="c1"># forward pass
</span>    <span class="n">ypred</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">:</span>
    <span class="n">ypred</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">net</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">ygt</span><span class="p">,</span><span class="n">yout</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span><span class="n">ypred</span><span class="p">):</span>
        <span class="n">loss</span><span class="o">+=</span> <span class="p">(</span><span class="n">yout</span><span class="o">-</span><span class="n">ygt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># backward pass
</span>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">net</span><span class="p">.</span><span class="nf">parameters</span><span class="p">():</span>
        <span class="n">p</span><span class="p">.</span><span class="n">grad</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>

    <span class="c1"># update
</span>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">n</span><span class="p">.</span><span class="nf">parameters</span><span class="p">():</span>
        <span class="n">p</span><span class="p">.</span><span class="n">data</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">p</span><span class="p">.</span><span class="n">grad</span>

    <span class="nf">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">loss</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
  
</code></pre></div></div>

<p>In this piece of code we train our net following this step :</p>

<ol>
  <li>Forward pass
We feed to the net the dataset and then we save the output of the net. Then we evaluate the loss using <a href="https://en.wikipedia.org/wiki/Mean_squared_error">MSE function</a>.</li>
  <li>Backward Pass
We reset all the gradient of all parameters and then we compute the new grad of each parameter calling backward on the loss function.</li>
  <li>Update
We update the parameters in the direction that minimize the loss function using a learning rate of 0.1</li>
</ol>

<h2 id="conclusion">Conclusion</h2>

<p>In this first part we built the foundamental for the understading of neural networks. In the next part we are going to see how to affine our techniques.</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Introduction]]></summary></entry></feed>